<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julio César Gaitán Silva">

<title>XGBOOST_Lim_Sup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="XGBOOST_Lim_Sup_files/libs/clipboard/clipboard.min.js"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/popper.min.js"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="XGBOOST_Lim_Sup_files/libs/quarto-html/anchor.min.js"></script>
<link href="XGBOOST_Lim_Sup_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="XGBOOST_Lim_Sup_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="XGBOOST_Lim_Sup_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="XGBOOST_Lim_Sup_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="XGBOOST_Lim_Sup_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">XGBOOST_Lim_Sup</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julio César Gaitán Silva </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cargar-librerías" class="level1">
<h1>1. Cargar librerías</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)        <span class="co"># Para ajuste de modelos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: lattice</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.80</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)       <span class="co"># Para trabajar con datos raster</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: sp</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)           <span class="co"># Para manipulación de datos espaciales</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.11.4, PROJ 9.7.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># Para manejar archivos Excel</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Conjunto de paquetes para manipulación de datos\library(DataExplorer) # Exploración de datos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ lubridate 1.9.4     ✔ tibble    3.3.0
✔ purrr     1.2.0     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks raster::extract(), terra::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ purrr::lift()    masks caret::lift()
✖ dplyr::select()  masks raster::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)        <span class="co"># Visualización de mapas\library(ithir)       # Modelado de suelos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aqp)         <span class="co"># Análisis de perfiles de suelo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is aqp 2.2-1

Adjuntando el paquete: 'aqp'

The following objects are masked from 'package:dplyr':

    combine, slice

The following objects are masked from 'package:raster':

    coordinates, metadata, metadata&lt;-, proj4string

The following objects are masked from 'package:sp':

    coordinates, coordinates&lt;-, proj4string, proj4string&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'kernlab'

The following object is masked from 'package:purrr':

    cross

The following objects are masked from 'package:raster':

    buffer, rotated

The following objects are masked from 'package:terra':

    buffer, size

The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
</div>
</section>
<section id="carpeta-donde-están-todos-los-rásters-ya-procesados" class="level1">
<h1>2 Carpeta donde están TODOS los rásters ya procesados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">"D:/Meta_vichada/aligned/"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>rasters_sel <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Aspect.tif",</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CI.tif"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"C.O.tif"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Convergence_Index.tif",</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Hillshade.tif",</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"HH.tif",</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HV.tif"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LS_Factor.tif"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MCARI.tif"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NDTI.tif"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Plan_Curvature.tif",</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Precipitación.tif",</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Profile_Curvature.tif",</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relative_Slope_Position.tif"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suelos_.tif"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Media_.tif",</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Topographic_Wetness_Index.tif"</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Total_Catchment_Area.tif",</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Valley_Depth.tif"</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"GNDVI.tif",</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"BSI.tif",</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Base_Level.tif",</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Distance.tif",</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"DEM.tif",</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"EVI.tif",</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NBR.tif",</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDVI.tif",</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDWI.tif",</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"SAVI.tif",</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Slope.tif"</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Maxima_.tif",</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Minima_.tif",</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="construir-rutas-completas-solo-de-los-seleccionados" class="level1">
<h1>3. Construir rutas completas SOLO de los seleccionados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta, rasters_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificar-cuáles-existen-control-de-errores" class="level1">
<h1>4. Verificar cuáles existen (control de errores)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> files_sel[<span class="fu">file.exists</span>(files_sel)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si alguno falta, aquí lo ves</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">basename</span>(files_sel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "CI.tif"                        "C.O.tif"                      
 [3] "HV.tif"                        "LS_Factor.tif"                
 [5] "MCARI.tif"                     "NDTI.tif"                     
 [7] "Relative_Slope_Position.tif"   "Suelos_.tif"                  
 [9] "Topographic_Wetness_Index.tif" "Valley_Depth.tif"             </code></pre>
</div>
</div>
</section>
<section id="cargar-como-spatraster" class="level1">
<h1>5. Cargar como SpatRaster</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>raster <span class="ot">&lt;-</span> <span class="fu">rast</span>(files_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificación-rápida" class="level1">
<h1>6. Verificación rápida</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareGeom</span>(raster, raster[[<span class="dv">1</span>]], <span class="at">stopOnError =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level1">
<h1>7. Visualización</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obtener-coordenadas-únicas" class="level1">
<h1>8. Obtener coordenadas únicas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>SCHS <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/SCHS.xlsx"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Coor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Perfil_COD1=</span>SCHS<span class="sc">$</span>Perfil_COD1,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Latitud =</span> SCHS<span class="sc">$</span>Latitud,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Longitud =</span> SCHS<span class="sc">$</span>Longitud,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Lim_sup =</span> SCHS<span class="sc">$</span>lim_sup )</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Coor)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Coor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   225 obs. of  4 variables:
 $ Perfil_COD1: chr  "AR-011" "AR-021" "AR-026" "AR-043" ...
 $ Latitud    : num  3.36 3.5 3.46 3.38 4.5 ...
 $ Longitud   : num  -73.7 -74 -73.9 -73.7 -71.3 ...
 $ Lim_sup    : num  13.8 13.5 11.7 16.8 27.6 ...</code></pre>
</div>
</div>
</section>
<section id="convertir-a-formato-espacial-sf" class="level1">
<h1>9. Convertir a formato espacial (sf)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_final_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> Coor,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitud"</span>, <span class="st">"Latitud"</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_final_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizar-los-puntos-sobre-el-modelo-de-elevación-dem" class="level1">
<h1>10. Visualizar los puntos sobre el modelo de elevación (DEM)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster<span class="sc">$</span>Topographic_Wetness_Index)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(data_final_sf), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-tmap" class="level1">
<h1>11. Visualización con tmap</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(raster<span class="sc">$</span>Topographic_Wetness_Index) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#CCCCCC"</span>, <span class="st">"#999999"</span>, <span class="st">"#666666"</span>, <span class="st">"#333333"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(data_final_sf) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">"Lim_sup"</span>, <span class="at">palette =</span> <span class="st">"-RdYlBu"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="st">"Mapa Lim_Sup cm"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_tm_raster()`: migrate the argument(s) related to the scale of the
visual variable `col` namely 'palette' (rename to 'values') to col.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_tm_dots()`: migrate the argument(s) related to the scale of the
visual variable `fill` namely 'palette' (rename to 'values') to fill.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_layout()`: use `tm_title()` instead of `tm_layout(title = )`
! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
SpatRaster object downsampled to 2505 by 3993 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extraer-valores-raster-en-los-puntos-espaciales" class="level1">
<h1>12. Extraer valores raster en los puntos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>extraccion <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(raster, <span class="fu">vect</span>(data_final_sf))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_sf, extraccion[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> (data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modelamiento--" class="level1">
<h1>Modelamiento —————————————————————-</h1>
</section>
<section id="resumen-de-los-datos-espaciales" class="level1">
<h1>13. Resumen de los datos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Perfil_COD1           Lim_sup              CI              C.O       
 Length:225         Min.   :  3.625   Min.   :0.1548   Min.   :16.10  
 Class :character   1st Qu.: 11.374   1st Qu.:0.5939   1st Qu.:22.62  
 Mode  :character   Median : 14.841   Median :0.7866   Median :25.25  
                    Mean   : 19.103   Mean   :0.9230   Mean   :26.68  
                    3rd Qu.: 22.794   3rd Qu.:1.1672   3rd Qu.:31.79  
                    Max.   :115.774   Max.   :2.3920   Max.   :70.25  
       HV            LS_Factor             MCARI               NDTI        
 Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.:-23.700   1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median :-19.620   Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   :-19.575   Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.:-15.374   3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   : -8.273   Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth              geometry  
 Min.   :  4.941   POINT        :225  
 1st Qu.:121.764   epsg:4326    :  0  
 Median :195.087   +proj=long...:  0  
 Mean   :237.062                      
 3rd Qu.:304.421                      
 Max.   :770.234                      </code></pre>
</div>
</div>
</section>
<section id="convertir-a-dataframe-para-modelado-no-se-tiene-en-cuenta-la-columna-id" class="level1">
<h1>14. Convertir a dataframe para modelado, no se tiene en cuenta la columna ID</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_sf)[<span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_sf_df)<span class="co">#</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Lim_sup              CI              C.O              HV         
 Min.   :  3.625   Min.   :0.1548   Min.   :16.10   Min.   :-31.215  
 1st Qu.: 11.374   1st Qu.:0.5939   1st Qu.:22.62   1st Qu.:-23.700  
 Median : 14.841   Median :0.7866   Median :25.25   Median :-19.620  
 Mean   : 19.103   Mean   :0.9230   Mean   :26.68   Mean   :-19.575  
 3rd Qu.: 22.794   3rd Qu.:1.1672   3rd Qu.:31.79   3rd Qu.:-15.374  
 Max.   :115.774   Max.   :2.3920   Max.   :70.25   Max.   : -8.273  
   LS_Factor             MCARI               NDTI        
 Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth    
 Min.   :  4.941  
 1st Qu.:121.764  
 Median :195.087  
 Mean   :237.062  
 3rd Qu.:304.421  
 Max.   :770.234  </code></pre>
</div>
</div>
</section>
<section id="mejor-semilla-particion-de-datos-y-mejor-modelo" class="level1">
<h1>15.Mejor Semilla particion de datos y mejor modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> data_sf_df<span class="sc">$</span>Lim_sup</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> data_sf_df[, <span class="sc">!</span>(<span class="fu">names</span>(data_sf_df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Lim_sup"</span>))]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>resultados_Lim_Sup_XGB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="fu">integer</span>(),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_test =</span> <span class="fu">numeric</span>(),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_test =</span> <span class="fu">numeric</span>()</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>best_rmse  <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>best_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(s)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(y, <span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  X_train <span class="ot">&lt;-</span> X[index, ]</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  X_test  <span class="ot">&lt;-</span> X[<span class="sc">-</span>index, ]</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  y_train <span class="ot">&lt;-</span> y[index]</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  y_test  <span class="ot">&lt;-</span> y[<span class="sc">-</span>index]</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_train, <span class="at">label =</span> y_train)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  dtest  <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(X_test,  <span class="at">label =</span> y_test)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">objective =</span> <span class="st">"reg:squarederror"</span>,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.05</span>,</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">3</span>,</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsample =</span> <span class="fl">0.8</span>,</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">colsample_bytree =</span> <span class="fl">0.8</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> params,</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dtrain,</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">100</span>,</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== TRAIN</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  pred_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtrain)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  RMSE_train <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_train, y_train)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  R2_train   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_train, y_train)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ===== </span><span class="al">TEST</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, dtest)</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred_test, y_test)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>  R2_test   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred_test, y_test)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>  resultados_Lim_Sup_XGB <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    resultados_Lim_Sup_XGB,</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> s,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_train =</span> RMSE_train,</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_train =</span> R2_train,</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_test =</span> RMSE_test,</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_test =</span> R2_test</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse) {</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>    best_rmse  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> modelo</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>    best_seed  <span class="ot">&lt;-</span> s</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>best_seed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 178</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>best_rmse</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.632708</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>##### xgb.Booster
call:
  xgb.train(params = params, data = dtrain, nrounds = 100, verbose = 0)
# of features: 10 
# of rounds:  100 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_Lim_Sup_XGB)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    seed RMSE_train  R2_train RMSE_test      R2_test
1      1   4.771665 0.9092966 15.054457 5.090299e-02
2      2   5.939869 0.9065891  9.952605 3.917041e-02
3      3   6.134691 0.8982885  8.978875 6.919898e-02
4      4   4.654411 0.9061942 15.472829 2.465602e-02
5      5   5.232054 0.8980701 14.392850 8.952601e-02
6      6   4.751957 0.8909445 17.227700 3.009121e-05
7      7   5.666351 0.9099880  9.696805 1.275192e-01
8      8   4.877952 0.8995177 15.425299 4.275416e-02
9      9   4.665091 0.9094680 16.844940 7.199536e-03
10    10   5.378591 0.9185884 12.530233 1.461063e-02
11    11   5.848392 0.8927839 11.926394 5.554733e-02
12    12   5.167449 0.9027191 14.566912 7.509223e-02
13    13   6.173563 0.8930910  9.437625 1.042556e-01
14    14   5.144717 0.8942079 15.217678 6.453874e-02
15    15   4.936620 0.9058672 15.540974 3.496118e-02
16    16   5.235978 0.9122402 12.896203 2.694512e-02
17    17   5.111929 0.9181989 12.823877 3.897150e-02
18    18   4.986197 0.8983058 15.969930 3.882121e-03
19    19   5.557793 0.9019204 12.836240 9.125928e-03
20    20   5.967725 0.8949725 10.783790 1.350045e-01
21    21   4.429006 0.8790385 19.070588 5.767528e-02
22    22   5.635270 0.9173116 12.000628 4.985132e-02
23    23   5.646898 0.9065872 11.283379 6.576729e-02
24    24   5.912185 0.8947323 11.225256 1.015869e-01
25    25   5.884547 0.8944861 11.800886 1.515981e-01
26    26   5.982362 0.9034902 10.899608 3.635012e-02
27    27   5.080898 0.9037052 15.122200 4.381274e-03
28    28   5.149848 0.8938625 15.207152 8.440353e-02
29    29   4.350533 0.9235475 16.095505 3.137583e-04
30    30   4.994811 0.8918737 14.810121 6.498549e-02
31    31   5.000175 0.8927065 17.044928 3.179478e-03
32    32   5.420543 0.9027193 14.087581 7.141982e-03
33    33   4.615292 0.9036104 17.873180 5.966300e-03
34    34   5.731666 0.9184263  9.661129 1.039322e-01
35    35   4.637480 0.9106840 15.873512 4.802775e-02
36    36   5.391178 0.9063045 13.860193 2.762678e-03
37    37   4.361808 0.8842323 18.472859 6.676383e-02
38    38   5.433306 0.9132595 11.643961 1.624934e-02
39    39   4.588792 0.9184585 16.021904 3.320403e-03
40    40   5.661154 0.9023634 11.941424 1.635248e-02
41    41   4.853749 0.9177695 15.288772 8.082314e-04
42    42   5.148968 0.9154327 14.066006 3.419101e-03
43    43   5.912719 0.8793738 13.122311 3.595903e-02
44    44   5.879422 0.8965691 10.917537 6.225332e-02
45    45   5.439481 0.9085639 14.398923 2.060208e-03
46    46   5.402382 0.8928914 15.727559 3.772014e-02
47    47   4.874886 0.9119648 15.002365 1.975010e-02
48    48   5.069345 0.8988657 15.008730 3.924447e-02
49    49   5.684469 0.9073014 11.733070 4.453406e-02
50    50   4.847819 0.8895066 16.888292 7.286428e-03
51    51   4.637891 0.9091955 16.334667 1.603901e-02
52    52   5.500047 0.9109367 12.258276 1.797983e-02
53    53   5.934509 0.9079462  9.649668 9.594485e-02
54    54   5.133165 0.8914199 15.753931 1.672975e-02
55    55   5.580087 0.9094579 10.652610 1.199407e-03
56    56   5.817171 0.9079666 14.354667 3.425221e-02
57    57   4.632164 0.9232231 15.977201 5.672009e-03
58    58   4.990867 0.8970947 15.300935 1.324876e-01
59    59   4.763744 0.9030554 17.357621 5.964491e-03
60    60   5.788787 0.9069544 10.813939 3.218661e-02
61    61   4.416478 0.8725160 19.704500 8.363727e-04
62    62   4.770671 0.9041191 15.367534 1.708745e-03
63    63   4.967223 0.8950451 15.424691 1.374523e-01
64    64   6.133950 0.8898633  9.884907 8.433113e-02
65    65   4.889465 0.9013695 14.736770 6.569422e-02
66    66   5.851633 0.9009304 11.664341 4.467127e-02
67    67   5.267149 0.9128096 12.223205 8.860146e-03
68    68   5.750213 0.8955552 11.748655 8.816551e-02
69    69   5.322930 0.8851979 15.591847 2.577955e-02
70    70   4.699856 0.9177412 15.238322 7.777365e-03
71    71   4.833268 0.9035757 14.773361 2.658163e-02
72    72   4.797531 0.8954908 16.398674 1.123769e-02
73    73   5.074595 0.8767073 15.432463 1.021346e-01
74    74   4.765910 0.9098573 15.890128 9.760206e-06
75    75   5.320324 0.9094159 13.576115 1.727522e-02
76    76   5.963887 0.8991273 11.469024 4.403037e-02
77    77   5.882562 0.8982160 10.984930 6.356624e-02
78    78   4.908231 0.9046841 14.662270 6.480863e-02
79    79   5.836793 0.9026981 11.364899 3.226419e-02
80    80   5.566930 0.9045912 16.263724 1.504713e-02
81    81   5.801113 0.8914623 14.013222 1.059281e-02
82    82   4.269875 0.8652884 20.474404 1.536695e-02
83    83   4.753006 0.9064787 16.204539 7.150680e-02
84    84   4.942302 0.9089276 15.724819 1.892818e-02
85    85   5.597830 0.9169732 10.890302 1.294333e-01
86    86   5.436791 0.9086528 13.389455 4.706666e-02
87    87   5.901046 0.8982742 16.067909 3.610025e-02
88    88   4.949671 0.8894280 16.688320 3.985987e-03
89    89   5.344821 0.9171597 13.237231 2.344179e-02
90    90   5.079836 0.8994683 14.525683 1.537972e-02
91    91   5.934663 0.8996712 11.744964 2.611257e-02
92    92   6.003760 0.9070847  9.404394 3.109396e-02
93    93   5.723666 0.9104197  9.890199 5.109183e-02
94    94   4.881424 0.9042497 14.470236 1.061991e-01
95    95   4.957117 0.8900355 15.864010 5.778367e-02
96    96   5.527395 0.9131501 14.035415 4.239637e-03
97    97   4.857815 0.9041140 15.219942 7.965098e-02
98    98   6.181324 0.8914547 10.017877 1.252695e-01
99    99   5.091756 0.9058175 14.989850 7.214430e-02
100  100   6.061212 0.8944244 12.259016 1.053096e-02
101  101   5.348065 0.9143791 14.031590 6.899853e-03
102  102   4.609590 0.9164667 15.772517 1.010395e-02
103  103   5.165169 0.8802281 16.517698 3.443478e-02
104  104   5.733091 0.9097177 12.250464 8.669655e-02
105  105   4.767701 0.9137486 15.229022 2.023469e-02
106  106   4.905622 0.9071218 15.186449 2.152172e-02
107  107   4.959367 0.8950804 14.956041 8.561041e-02
108  108   4.515928 0.8792220 19.034078 1.206855e-02
109  109   5.504997 0.9063656 15.329763 3.815739e-03
110  110   5.842352 0.8985837 12.314565 4.191387e-02
111  111   5.165959 0.9180124 15.708336 2.987623e-05
112  112   5.706634 0.9140782 10.167946 7.887815e-02
113  113   4.318108 0.8829268 19.275398 1.158828e-02
114  114   5.747807 0.9051558 10.766369 2.554407e-02
115  115   5.325027 0.8902424 15.099850 4.284428e-02
116  116   4.507560 0.9057526 17.196242 4.658236e-02
117  117   4.604504 0.9132596 15.294162 5.610431e-02
118  118   5.021746 0.9035744 15.359081 1.652703e-02
119  119   5.546055 0.8998154 12.885396 1.411710e-02
120  120   5.660694 0.9129927 11.504108 4.794721e-02
121  121   4.874903 0.9005759 15.572466 5.180284e-02
122  122   4.838140 0.9135902 14.633025 8.306810e-02
123  123   5.732930 0.9063178 10.433414 8.290072e-02
124  124   4.938351 0.9163746 14.941963 2.241491e-03
125  125   5.650378 0.9091487 11.124005 1.164891e-01
126  126   5.413246 0.9161174 12.874506 1.078997e-02
127  127   5.283573 0.8866047 15.090401 1.764726e-02
128  128   4.857117 0.9027911 15.738198 1.946216e-02
129  129   5.857867 0.9070028 10.507457 1.741182e-02
130  130   4.328573 0.8850153 18.331081 4.467974e-02
131  131   4.982946 0.9029365 15.792877 3.460024e-02
132  132   4.680824 0.8774514 17.379791 6.427591e-02
133  133   5.153287 0.8923536 14.885437 5.646893e-02
134  134   5.043077 0.8914720 15.860365 2.718792e-03
135  135   5.766054 0.9122906 10.648358 2.019625e-02
136  136   5.523700 0.8997300 13.232387 4.381207e-02
137  137   6.074413 0.8977616  9.921365 9.372121e-02
138  138   4.886072 0.9110346 13.776819 4.066982e-02
139  139   5.334271 0.9159211 12.487250 9.760370e-04
140  140   5.090270 0.8951984 14.949561 3.630126e-02
141  141   5.180868 0.9069540 14.096983 8.973387e-02
142  142   4.914984 0.8958614 16.720372 1.609456e-02
143  143   5.790165 0.8927130 11.714045 4.243221e-02
144  144   4.016587 0.8959322 19.595038 3.331382e-02
145  145   5.785455 0.9015556 12.158060 3.737729e-02
146  146   5.058499 0.9033535 14.789021 3.862664e-03
147  147   4.442530 0.9000820 17.267066 3.214244e-02
148  148   4.801921 0.9083797 14.424663 9.346798e-03
149  149   4.954976 0.8925977 16.448947 4.000658e-02
150  150   5.236098 0.9016223 14.724448 9.543081e-02
151  151   5.029789 0.8989615 15.938036 8.752333e-03
152  152   4.848040 0.9083702 15.303130 1.363664e-02
153  153   5.511579 0.9131384 13.891615 2.551555e-02
154  154   4.891776 0.9106545 16.723355 1.494140e-02
155  155   4.866896 0.9142792 14.053155 2.430691e-02
156  156   5.834210 0.8915370 14.414855 3.560708e-03
157  157   5.027498 0.8885759 15.408410 4.300355e-02
158  158   4.754109 0.9003390 15.781708 2.136928e-02
159  159   4.616962 0.8698848 17.777624 7.563920e-02
160  160   4.306837 0.9171731 16.571905 4.920207e-02
161  161   4.647131 0.9043576 16.788252 6.557712e-03
162  162   5.496739 0.9229311 10.359318 6.851169e-02
163  163   5.740394 0.9106617 10.843020 4.261216e-02
164  164   5.973761 0.8933149 13.040811 3.277073e-03
165  165   5.559474 0.9032617 11.827543 1.731948e-02
166  166   6.053359 0.8949587 11.637088 1.111054e-02
167  167   6.124625 0.8983632  8.802861 8.908375e-02
168  168   4.529440 0.8973457 17.979216 1.538316e-02
169  169   4.821297 0.8994487 15.898882 5.958852e-02
170  170   5.639155 0.9021127 10.788117 1.320863e-01
171  171   5.474064 0.9137515 11.628740 2.509560e-02
172  172   4.040561 0.8957908 18.751600 1.084006e-02
173  173   5.788497 0.9055173 10.929651 6.998424e-02
174  174   5.695482 0.9151003  9.788326 1.621152e-02
175  175   4.348003 0.8639116 19.843472 3.153146e-03
176  176   4.823878 0.9063536 14.525254 4.435691e-02
177  177   5.174289 0.9031537 14.937402 4.471671e-02
178  178   6.208622 0.8965995  7.632708 2.563566e-01
179  179   4.158972 0.9023645 17.719846 4.393765e-02
180  180   5.632828 0.8984081 12.620197 1.977968e-02
181  181   4.917928 0.9012340 16.346729 1.574148e-02
182  182   5.468714 0.9052336 13.251602 2.056448e-02
183  183   5.597600 0.9082681 13.623902 3.357675e-02
184  184   4.234367 0.8751380 19.120516 4.089737e-02
185  185   5.007873 0.9071961 14.915343 5.528034e-02
186  186   5.999065 0.9070926  8.427209 1.292956e-01
187  187   4.871621 0.9081980 16.016745 2.492696e-03
188  188   6.122357 0.8955544  9.539664 1.756763e-01
189  189   4.958780 0.8972187 16.190588 3.022115e-02
190  190   4.683887 0.9088137 15.226045 1.603142e-02
191  191   5.383978 0.8975557 14.991170 5.381711e-03
192  192   4.592671 0.9189012 15.728898 9.399824e-02
193  193   5.680050 0.9007439 11.379013 6.391455e-02
194  194   5.069526 0.8952040 14.285674 3.146076e-02
195  195   5.595496 0.9038192 13.936219 1.212537e-02
196  196   5.499148 0.9159586 12.597516 1.101622e-02
197  197   5.669233 0.8949369 13.598180 5.813631e-03
198  198   5.610977 0.9026803 10.791361 5.346983e-02
199  199   5.984015 0.8805494 14.174820 2.591170e-02
200  200   5.903307 0.8937053 12.844368 6.950100e-03
201  201   5.360111 0.8941712 16.225617 1.262954e-02
202  202   5.301837 0.8895063 14.533390 5.341314e-02
203  203   5.939845 0.9022408  9.615128 1.210839e-01
204  204   4.984692 0.8924473 16.427547 4.420289e-02
205  205   4.775788 0.9040736 15.249593 6.590872e-03
206  206   5.834584 0.9101036  9.186603 5.775633e-02
207  207   4.083030 0.8831973 18.885768 4.615522e-02
208  208   5.083634 0.8995151 15.762740 9.343817e-03
209  209   5.372349 0.9166725 12.966982 1.868850e-02
210  210   5.789127 0.9031974 11.425961 2.612192e-02
211  211   4.978103 0.8895596 18.153271 1.659864e-03
212  212   4.838829 0.9094441 16.375596 8.830410e-03
213  213   5.162982 0.8976550 14.584237 4.095622e-02
214  214   5.534753 0.9041921 12.065712 3.166024e-03
215  215   5.451810 0.9193204 11.988795 1.386706e-03
216  216   4.537030 0.9217474 15.517061 3.993198e-02
217  217   5.820637 0.9165505  9.060376 2.755206e-02
218  218   5.567079 0.9150275 11.172186 1.322966e-02
219  219   5.559167 0.9113332 11.952842 3.663289e-02
220  220   5.563070 0.9164605 12.413538 5.732045e-04
221  221   5.863601 0.8986569 12.950334 3.910625e-02
222  222   5.476397 0.9199159 11.369961 1.114631e-01
223  223   5.711039 0.9039314 11.916512 2.304165e-02
224  224   5.916165 0.9004754 12.304929 3.417053e-02
225  225   5.950235 0.9002817 10.126181 1.214816e-01
226  226   5.466662 0.8939730 13.498432 8.446211e-03
227  227   5.197744 0.9171245 13.469286 8.645149e-04
228  228   5.280064 0.9166276 13.669506 1.186133e-02
229  229   5.304421 0.8898679 15.553221 9.365795e-02
230  230   6.006796 0.8924142 13.073779 5.201841e-02
231  231   4.597413 0.9166760 17.062260 1.454971e-02
232  232   5.744892 0.9042602 10.652356 6.908033e-02
233  233   5.510361 0.9074556 11.059739 1.257680e-01
234  234   5.169819 0.8835149 16.107665 9.975895e-02
235  235   4.955269 0.8973523 16.495298 1.325876e-02
236  236   5.957358 0.9060399  9.169031 7.842267e-02
237  237   5.966224 0.8943329 10.836594 7.916569e-02
238  238   5.664191 0.9178818  9.551465 1.677089e-01
239  239   3.716848 0.9083468 19.801927 2.987326e-02
240  240   4.693291 0.9035306 15.626400 2.396578e-02
241  241   4.726592 0.9003735 16.304030 8.868793e-03
242  242   5.320401 0.8851013 14.721684 1.054655e-01
243  243   4.465794 0.9045821 16.838432 4.782862e-02
244  244   5.866651 0.9030514 12.295712 3.317001e-02
245  245   4.879082 0.9024903 15.371501 3.591989e-02
246  246   4.880546 0.8978228 16.084000 9.617976e-03
247  247   5.603768 0.9200056  9.144800 7.842747e-02
248  248   5.421388 0.9129205 11.310422 1.966353e-02
249  249   5.997947 0.8840466 12.120403 5.153856e-02
250  250   5.738209 0.8944316 12.777559 7.412166e-02
251  251   4.737429 0.9055034 15.791284 6.699313e-02
252  252   4.574141 0.9124157 16.266940 1.017794e-02
253  253   4.477203 0.9142877 15.994550 1.869550e-02
254  254   4.978772 0.9150447 14.964803 9.384466e-04
255  255   5.803965 0.9126384 11.242902 4.275212e-02
256  256   5.514252 0.9093403 11.787931 5.268633e-02
257  257   6.192510 0.8844279 10.433422 5.875343e-02
258  258   3.878480 0.9095484 18.292063 5.043885e-02
259  259   5.541400 0.9025649 12.699411 5.181834e-02
260  260   4.751760 0.9158410 16.107498 1.835010e-03
261  261   5.877411 0.8999758 10.493397 8.913694e-02
262  262   5.743329 0.8986537 12.266459 2.770584e-02
263  263   4.160316 0.8889544 19.525565 1.642562e-02
264  264   5.396244 0.9251816 11.034938 3.903584e-02
265  265   4.044669 0.8913443 19.445387 5.920556e-03
266  266   4.368586 0.8725775 19.169224 1.351085e-02
267  267   5.914382 0.9122171  9.495106 5.981736e-02
268  268   5.209121 0.8797059 14.653177 2.843378e-02
269  269   4.151038 0.8878609 19.051737 1.085012e-01
270  270   6.028235 0.9053776 10.123960 5.350514e-02
271  271   4.073607 0.8920238 19.035934 3.442859e-02
272  272   5.540776 0.9146098 10.777918 3.728558e-04
273  273   5.194569 0.8992112 14.766605 5.186160e-02
274  274   6.238596 0.8892678  9.641533 4.853919e-02
275  275   5.375393 0.9103332 13.305188 2.250256e-03
276  276   4.662177 0.9049362 16.527336 1.502347e-02
277  277   5.618622 0.9119465 11.069254 2.176844e-02
278  278   5.742337 0.8994795 11.563258 4.492311e-02
279  279   4.957874 0.8945603 14.762239 7.309478e-02
280  280   5.719390 0.9102989 10.925655 2.565976e-02
281  281   6.084096 0.9059520 10.047347 3.795673e-02
282  282   5.608874 0.9005543 13.514115 7.834666e-03
283  283   5.239982 0.8888362 15.775564 1.155646e-02
284  284   5.906142 0.8989086 10.959990 3.602382e-02
285  285   4.969906 0.9024820 14.669303 2.584442e-02
286  286   4.780243 0.9068888 15.022966 2.587266e-02
287  287   5.596945 0.8998672 12.195632 1.237273e-02
288  288   5.388307 0.9025389 13.081139 3.974417e-02
289  289   5.379381 0.8985144 19.197631 3.959041e-04
290  290   5.862101 0.9019051 10.408711 5.939008e-02
291  291   4.793682 0.9087689 14.912525 2.001938e-02
292  292   5.413499 0.9205190 11.646758 8.111713e-02
293  293   5.438947 0.9161997 11.471541 8.408373e-04
294  294   5.277786 0.9250272 11.782761 6.096513e-03
295  295   4.335939 0.9078609 17.824513 4.191608e-03
296  296   4.885243 0.8961413 16.118087 5.044206e-04
297  297   5.542959 0.9182273 11.871996 2.465261e-02
298  298   4.741272 0.8981499 16.952988 1.882437e-02
299  299   4.903592 0.9036650 14.965035 7.438619e-02
300  300   4.790410 0.9007132 17.530858 9.050113e-03
301  301   5.427798 0.9163085 10.592183 9.221578e-02
302  302   5.713827 0.9103661 11.787974 2.266976e-02
303  303   5.739790 0.9075616 10.692833 6.173231e-02
304  304   4.912957 0.8997931 15.223560 3.162051e-02
305  305   5.323271 0.8916700 14.465644 1.335665e-01
306  306   4.708407 0.9120535 14.886990 3.727466e-04
307  307   5.153698 0.8985757 14.325723 4.852838e-03
308  308   5.038744 0.9001888 14.111538 5.560457e-02
309  309   4.306230 0.9138755 16.622892 1.234217e-02
310  310   5.865707 0.8976105 10.573944 3.290283e-02
311  311   4.793935 0.9031462 16.120315 3.506232e-02
312  312   5.063344 0.8974294 15.523374 4.793197e-03
313  313   5.997186 0.8894664 11.084553 4.715118e-02
314  314   4.954665 0.9006957 15.828276 1.136204e-03
315  315   5.985920 0.9008173  8.840295 1.032887e-01
316  316   4.935776 0.9025317 15.143737 2.075094e-02
317  317   5.814489 0.9071025 10.729931 1.957584e-02
318  318   5.374365 0.9129001 11.186821 3.517799e-02
319  319   5.028866 0.9002605 15.876111 4.148367e-02
320  320   5.348754 0.9211708 12.863075 1.033551e-02
321  321   5.993319 0.9004426  8.808275 1.652013e-01
322  322   5.552115 0.8960730 14.056822 5.834316e-03
323  323   5.677657 0.8998238 10.759254 8.439168e-02
324  324   5.029128 0.8987467 16.144096 2.448210e-02
325  325   5.398966 0.9104746 13.406329 4.010067e-03
326  326   5.718367 0.9050248 11.388392 1.144538e-02
327  327   5.288680 0.8994101 14.328806 5.903104e-04
328  328   4.311804 0.9022723 18.770516 4.615219e-03
329  329   5.797429 0.9043263 12.543403 2.178762e-02
330  330   5.059400 0.8950266 15.345390 1.858674e-02
331  331   5.077469 0.9006752 16.428668 5.666170e-03
332  332   6.052994 0.8982989  8.934250 1.293970e-01
333  333   6.210005 0.8951130  7.912138 3.264717e-01
334  334   5.617085 0.9067849 12.072268 3.540772e-02
335  335   4.984755 0.9114871 14.494770 2.766509e-02
336  336   5.298193 0.9097262 14.168928 3.861655e-02
337  337   4.543633 0.9007129 19.677909 6.415492e-05
338  338   4.854806 0.8993958 15.512804 1.827993e-02
339  339   5.328564 0.8921986 14.772043 1.361334e-02
340  340   5.714385 0.8929564 12.262460 7.858954e-03
341  341   5.682455 0.9012354 11.345925 1.588780e-02
342  342   3.987834 0.8996849 19.167186 2.205132e-02
343  343   5.838193 0.9113173 11.427463 1.474252e-02
344  344   4.919077 0.8976071 16.448741 1.547777e-02
345  345   4.982892 0.8900558 17.075965 2.562933e-02
346  346   5.796464 0.9017194 10.257826 1.675085e-02
347  347   4.736825 0.9112148 17.360943 1.179468e-02
348  348   5.991581 0.9052067  9.831760 4.641898e-02
349  349   6.127580 0.8921258 10.824839 2.822491e-02
350  350   4.421099 0.8819214 18.386300 1.657111e-02
351  351   5.302878 0.9141348 12.630258 1.109682e-02
352  352   5.442964 0.9146383 14.306370 1.754679e-03
353  353   5.147142 0.9013012 14.690445 2.792930e-03
354  354   4.842231 0.8982772 15.205486 7.729283e-02
355  355   5.548992 0.9176484 10.947331 4.632017e-02
356  356   6.135084 0.8855852 11.080848 4.334995e-02
357  357   4.890713 0.9035129 14.786502 8.199649e-02
358  358   5.754684 0.9073317 10.627488 1.227307e-01
359  359   5.776752 0.9011544 13.235443 2.805247e-02
360  360   5.493966 0.9111170 12.790325 6.103722e-02
361  361   5.970908 0.9061684  9.341141 6.724471e-02
362  362   5.677689 0.9084306 11.614285 7.894638e-03
363  363   5.472102 0.9145781 11.657793 1.361612e-02
364  364   5.129945 0.8975233 15.568357 3.430535e-02
365  365   5.833206 0.8936392 13.935277 2.291127e-04
366  366   5.630056 0.9035568 13.375194 2.261154e-02
367  367   5.436743 0.9102978 12.048772 1.889824e-02
368  368   5.140779 0.8891969 14.087360 1.134671e-01
369  369   5.761160 0.8997292 11.368842 5.257297e-02
370  370   5.026212 0.8761158 16.507172 9.272146e-03
371  371   5.570942 0.9019405 12.774487 5.806489e-03
372  372   4.914776 0.9040054 16.226676 1.401089e-02
373  373   4.801791 0.9020853 16.615498 1.536032e-02
374  374   4.699182 0.9096974 15.332803 3.562574e-02
375  375   5.480698 0.9062215 12.294698 2.560639e-02
376  376   4.612784 0.9050079 16.852986 1.960971e-03
377  377   5.087173 0.8984028 15.645487 2.426266e-02
378  378   4.764451 0.9075298 15.510385 7.403002e-03
379  379   5.532693 0.8968333 12.598829 5.253375e-02
380  380   5.981098 0.8963891 11.515406 9.330177e-03
381  381   5.244297 0.8975980 13.785160 5.927782e-02
382  382   4.828978 0.8983568 15.134350 1.558876e-02
383  383   5.811241 0.9012077 13.311593 1.400583e-02
384  384   5.650323 0.9043080 11.087392 6.715544e-02
385  385   5.378284 0.9205535 11.493624 2.455206e-02
386  386   5.697349 0.9101833  9.765077 7.536447e-02
387  387   5.893227 0.8948219 11.284525 5.794419e-02
388  388   4.648527 0.9072988 15.453734 5.724324e-02
389  389   5.557756 0.9115648 11.231963 4.725160e-02
390  390   4.953360 0.8971241 14.729186 4.704008e-02
391  391   4.828951 0.8883837 16.403768 4.994671e-02
392  392   5.061062 0.8982459 14.570313 1.054540e-01
393  393   5.827943 0.9116457 10.275944 8.843516e-02
394  394   4.850806 0.9132130 14.255712 1.447983e-02
395  395   6.023032 0.9032463 10.986983 6.499650e-02
396  396   6.196075 0.9003472  9.641766 1.634634e-01
397  397   4.875274 0.9107142 15.019197 2.660310e-02
398  398   5.036094 0.8815306 16.131596 2.217931e-02
399  399   4.416282 0.9225781 16.041934 4.379623e-02
400  400   4.774443 0.9026303 14.468716 3.857989e-02
401  401   4.609546 0.9167185 16.168714 2.399698e-03
402  402   4.776434 0.9180672 15.394607 5.513303e-02
403  403   5.410488 0.8909063 13.717215 4.447932e-02
404  404   4.623556 0.8797231 18.036961 4.703572e-02
405  405   5.297697 0.9108573 13.121727 8.035965e-02
406  406   4.956526 0.9047900 15.693675 4.127361e-02
407  407   5.206999 0.9234741 13.243894 4.488004e-03
408  408   6.025957 0.8971943 10.362862 1.614621e-01
409  409   5.003182 0.9197264 16.313908 4.149045e-03
410  410   5.624009 0.9129599 11.078289 6.928363e-02
411  411   4.899641 0.9120867 14.361137 2.847199e-02
412  412   5.166260 0.8909864 14.749294 1.437448e-01
413  413   5.641723 0.9080875 11.128133 1.144990e-02
414  414   5.106870 0.8925320 14.987671 3.418932e-02
415  415   5.241127 0.9238218 11.945392 3.464372e-02
416  416   4.688146 0.9115764 15.608794 2.008774e-02
417  417   4.800842 0.8917581 17.907297 3.109324e-03
418  418   4.567288 0.9089543 17.210931 1.395958e-03
419  419   4.727602 0.8975830 17.339710 8.873753e-03
420  420   4.875918 0.9065556 15.389539 2.454768e-02
421  421   4.588116 0.8990749 17.136391 5.239126e-02
422  422   4.846015 0.9052230 15.619435 1.238411e-03
423  423   5.752477 0.9028369 11.302280 6.544300e-02
424  424   5.435871 0.8947235 15.615701 1.313364e-03
425  425   4.239040 0.8952221 18.591675 4.445667e-02
426  426   4.795976 0.8942117 17.149925 1.348226e-03
427  427   4.985649 0.8954512 16.099931 4.337409e-02
428  428   5.080984 0.8942812 15.290133 2.397214e-02
429  429   5.420855 0.9090634 13.276100 1.653582e-02
430  430   4.262439 0.8951756 17.919888 5.604931e-02
431  431   5.029923 0.8919294 15.822602 2.078339e-02
432  432   5.553613 0.9049285 12.430083 2.004049e-02
433  433   5.321616 0.9062136 13.052399 2.425235e-02
434  434   6.027642 0.8976407 11.772611 2.746637e-02
435  435   5.283717 0.9210201 12.938956 5.358874e-03
436  436   5.994664 0.8983750 10.375238 3.228051e-02
437  437   4.682736 0.9196416 15.673810 3.681085e-02
438  438   4.309135 0.9247122 16.074312 2.597677e-03
439  439   4.139963 0.8921711 17.973065 5.670703e-02
440  440   4.336566 0.8904171 18.440949 5.308039e-03
441  441   4.994050 0.9041407 14.391097 1.696179e-04
442  442   4.740580 0.9030465 16.936494 2.930611e-02
443  443   5.357493 0.9034300 16.312861 1.313957e-03
444  444   5.016894 0.9052335 15.327696 6.863812e-03
445  445   4.778680 0.8931018 16.540267 3.861512e-02
446  446   5.670593 0.9052849 11.485851 3.073134e-02
447  447   5.987895 0.9038454 10.074064 6.361002e-02
448  448   5.546672 0.9002764 12.188128 1.984916e-02
449  449   5.554461 0.9090930 11.773910 6.818350e-02
450  450   5.661588 0.9087729 12.041745 1.441595e-02
451  451   5.558425 0.9031981 12.326034 7.787126e-03
452  452   5.577237 0.9114897 11.782503 2.821439e-02
453  453   5.901632 0.8993295 12.335969 1.581333e-02
454  454   5.875173 0.9001231 11.651157 8.703993e-02
455  455   5.455957 0.9211180 11.194148 2.157604e-02
456  456   4.874146 0.9013792 16.104509 2.148855e-03
457  457   5.997151 0.8788024 13.224662 2.717556e-02
458  458   5.069652 0.9037500 14.320656 2.666964e-02
459  459   5.803031 0.9039337 11.075700 8.298545e-02
460  460   5.706012 0.8981459 12.503215 2.147773e-02
461  461   4.915142 0.9006629 15.557886 1.951559e-02
462  462   5.538631 0.9170006 11.192127 3.217378e-02
463  463   4.405964 0.8873696 18.564592 4.837375e-02
464  464   5.144050 0.9124235 14.042074 2.262953e-02
465  465   5.595059 0.9084879 11.571963 6.631273e-05
466  466   5.867775 0.8870401 12.577346 2.628902e-02
467  467   4.906939 0.9044971 15.853322 2.588123e-02
468  468   6.077290 0.8931981 10.257057 1.629964e-01
469  469   4.928753 0.9011309 14.876817 1.087218e-02
470  470   5.796634 0.8818521 15.103542 1.776459e-02
471  471   5.769651 0.8959788 12.276777 5.521065e-03
472  472   4.855154 0.9118078 14.937827 4.718438e-02
473  473   5.391705 0.9052738 16.430687 7.749173e-05
474  474   5.617745 0.9178219 10.326553 4.795204e-02
475  475   4.947730 0.8932024 16.116707 2.867434e-02
476  476   5.844164 0.9004329 11.463828 5.427044e-02
477  477   4.923835 0.9027378 15.781595 1.306086e-03
478  478   5.238056 0.9036066 15.006279 4.542897e-02
479  479   4.774523 0.9060974 16.251343 3.893812e-04
480  480   4.488044 0.9195145 15.541304 2.297825e-02
481  481   4.714314 0.9236838 15.870373 9.769841e-03
482  482   4.189901 0.8820897 19.391834 3.334340e-02
483  483   5.800885 0.8985208 12.268571 5.335229e-02
484  484   4.986422 0.8950097 14.781904 8.458519e-02
485  485   4.578141 0.8724696 18.045448 5.471245e-02
486  486   5.499408 0.9170709 11.211285 2.734346e-02
487  487   5.505963 0.9190441 12.759946 6.535726e-03
488  488   5.068468 0.8934760 16.894518 1.770447e-02
489  489   5.205005 0.8922660 16.237519 7.095362e-03
490  490   4.922026 0.8992090 15.829823 6.957511e-02
491  491   5.482296 0.9049561 14.593288 1.830773e-04
492  492   5.674889 0.9143267  9.780414 5.198965e-02
493  493   5.272829 0.9020675 14.502531 3.712401e-03
494  494   5.146397 0.8937600 14.276912 8.816201e-02
495  495   5.913403 0.8915826 11.573466 1.720198e-02
496  496   5.019204 0.9002719 15.845218 3.300738e-02
497  497   5.860706 0.9136142  9.517523 1.703602e-01
498  498   5.732439 0.8966300 14.176505 1.772718e-02
499  499   3.991832 0.8989574 18.640577 2.788179e-02
500  500   4.856081 0.9154499 14.998358 3.226912e-02</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables" class="level1">
<h1>16.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>var_imp_xgb <span class="ot">&lt;-</span> <span class="fu">xgb.importance</span>(</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(var_imp_xgb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Feature       Gain      Cover Frequency
                      &lt;char&gt;      &lt;num&gt;      &lt;num&gt;     &lt;num&gt;
1:              Valley_Depth 0.13951227 0.12782170 0.1065183
2:                        CI 0.13391180 0.07123167 0.1605723
3:                 LS_Factor 0.12951805 0.10438989 0.1208267
4: Topographic_Wetness_Index 0.12411441 0.21920836 0.1414944
5:                      NDTI 0.11363267 0.13029231 0.1096979
6:                       C.O 0.09216743 0.09141267 0.1001590</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables-1" class="level1">
<h1>17.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables  =</span> var_imp_xgb<span class="sc">$</span>Feature,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> var_imp_xgb<span class="sc">$</span>Gain</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>var_imp_xgb_df <span class="ot">&lt;-</span> var_imp_xgb_df[<span class="fu">order</span>(<span class="sc">-</span>var_imp_xgb_df<span class="sc">$</span>importance), ]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_imp_xgb_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   variables importance
1               Valley_Depth 0.13951227
2                         CI 0.13391180
3                  LS_Factor 0.12951805
4  Topographic_Wetness_Index 0.12411441
5                       NDTI 0.11363267
6                        C.O 0.09216743
7                      MCARI 0.08974821
8                         HV 0.06590582
9                    Suelos_ 0.06361696
10   Relative_Slope_Position 0.04787238</code></pre>
</div>
</div>
</section>
<section id="se-grafican-para-entender-cúal-está-influyendo-más-en-el-modelo" class="level1">
<h1>18.Se grafican para entender cúal está influyendo más en el modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>XGBOOTS_Sup <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(var_imp_xgb_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(importance),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variables, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Importancia"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Importancia de variables – XGBoost (Lim_sup)"</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XGBOOTS_Sup)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-grafica-importancia_variables" class="level1">
<h1>19. Guardar grafica Importancia_variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Importancia_variables_XGB.png"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> XGBOOTS_Sup,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">14</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="predicción-y-visualización" class="level1">
<h1>Predicción y visualización</h1>
</section>
<section id="nombres-de-capas-variables-del-modelo" class="level1">
<h1>20.Nombres de capas = variables del modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dataVARS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"CI"</span>,<span class="st">"C.O"</span>, <span class="st">"MCARI"</span>, <span class="st">"LS_Factor"</span>, <span class="st">"NDTI"</span>, <span class="st">"HV"</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"Relative_Slope_Position"</span>, <span class="st">"Suelos_"</span>, <span class="st">"Topographic_Wetness_Index"</span> ,<span class="st">"Valley_Depth"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En terra usamos 'subset' para quedarnos solo con las capas que necesitamos</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que tu objeto raster se llama 'raster' (o cámbiale el nombre)</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>r_predictores <span class="ot">&lt;-</span> <span class="fu">subset</span>(raster, dataVARS)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación de seguridad (Debe salir T</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"¿Están todas las variables?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "¿Están todas las variables?"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">all</span>(dataVARS <span class="sc">%in%</span> <span class="fu">names</span>(r_predictores)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="aplicar-modelo" class="level1">
<h1>21. Aplicar modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Limite_Sup_XGB <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  r_predictores,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cf">function</span>(model, d, ...) {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(model, <span class="fu">as.matrix</span>(d))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  Limite_Sup_XGB,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Superior (XGBoost)"</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-modelo-rf_grid" class="level1">
<h1>22. Guardar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Limite_Sup_XGB, <span class="st">"D:/Mapa final/Limite_Superior_XGB.tif"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
</div>
</section>
<section id="guardar-imagen-png-modelo" class="level1">
<h1>23. Guardar imagen png modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_XGB.png"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  Limite_Sup_XGB,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Superior del departamento de Meta y Vichada (XGB)"</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="recorte-de-un-area-especifica" class="level1">
<h1>24. Recorte de un area especifica</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Raster de predicción</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Limite_Sup_XGB   <span class="co"># o rast("Limite_Inferior_XGB.tif")</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Polígono de la zona de interés</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/shp tesis/Altillanura_2.shp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reproyectar" class="level1">
<h1>25. Reproyectar</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">project</span>(zona, <span class="fu">crs</span>(r))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cortar-area-de-estudio" class="level1">
<h1>26. Cortar area de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(r, zona)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_crop, zona)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="mapa" class="level1">
<h1>27. Mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_crop, <span class="at">main =</span> <span class="st">"Predicion Limite Superior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="XGBOOST_Lim_Sup_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-mapa" class="level1">
<h1>28. Guardar mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/Mapa final/Lim_sup_XGB_Altillanura.tif"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="guardar-mapa-como-imagen" class="level1">
<h1>29. Guardar mapa como imagen</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_Altillanura_XGB.png"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicion Limite Superior (XGB)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>